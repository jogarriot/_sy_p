<!-- ---
name: n8n Workflow Development
description: Auto-invoked when user mentions "n8n workflow", "n8n project", "sync workflows", "push workflow", "workflow automation", or discusses n8n node configuration. Provides guidance on n8n workflow structure, editing JSON workflows programmatically, and best practices.
version: 13.3
---

# n8n Workflow Development

## Overview

This skill helps you work with n8n workflows in Vibespace. n8n is a workflow automation tool that stores workflows as JSON files with nodes, connections, and settings.

## Available MCP Tools

Use these tools via the `workspace` MCP server:

| Tool | Usage |
|------|-------|
| `mcp__plugin_workspace__list_workflows` | List all workflows in a project |
| `mcp__plugin_workspace__get_workflow` | Get full workflow JSON by ID or name |
| `mcp__plugin_workspace__sync_workflows` | Pull workflows from remote n8n instance |
| `mcp__plugin_workspace__push_workflow` | Push local changes to remote n8n |

## Workflow JSON Structure

n8n workflows follow this structure:

```json
{
  "id": "abc123...",
  "name": "My Workflow",
  "active": true,
  "nodes": [
    {
      "id": "node-uuid",
      "name": "Node Name",
      "type": "n8n-nodes-base.httpRequest",
      "position": [250, 300],
      "parameters": { ... }
    }
  ],
  "connections": {
    "Node Name": {
      "main": [[{ "node": "Next Node", "type": "main", "index": 0 }]]
    }
  },
  "settings": {
    "executionOrder": "v1"
  }
}
```

## Common Node Types

| Node Type | Purpose |
|-----------|---------|
| `n8n-nodes-base.httpRequest` | Make HTTP/API calls |
| `n8n-nodes-base.code` | Run JavaScript/Python code |
| `n8n-nodes-base.if` | Conditional branching |
| `n8n-nodes-base.switch` | Multi-path branching |
| `n8n-nodes-base.merge` | Combine data from branches |
| `n8n-nodes-base.set` | Transform/set data fields |
| `n8n-nodes-base.webhook` | Receive HTTP webhooks |
| `n8n-nodes-base.schedule` | Time-based triggers |

## Best Practices

### Editing Workflows

1. **Always sync first**: Before editing, run `sync_workflows` to get latest version
2. **Preserve IDs**: Keep existing node IDs to maintain execution history
3. **Test locally**: n8n can import/export JSON for local testing
4. **Push carefully**: Use `push_workflow` to deploy - it overwrites the remote version

### Node Connections

Connections use the source node's name as the key:

```json
"connections": {
  "HTTP Request": {
    "main": [[
      { "node": "Process Data", "type": "main", "index": 0 }
    ]]
  }
}
```

- `main` is the primary output
- `index` refers to which input of the target node (0 = first input)

### Error Handling

Add error outputs to critical nodes:

```json
{
  "type": "n8n-nodes-base.httpRequest",
  "onError": "continueErrorOutput",
  "parameters": { ... }
}
```

Then connect the error output (index 1) to an error handler node.

## Project Setup Requirements

For sync/push to work, ensure your n8n project has:

1. **API Key**: Set `N8N_API_KEY` in project's `envSettings`
2. **External URL**: Set `externalUrl` in project-info.yml

Example project-info.yml:
```yaml
name: my-n8n-project
type: n8n
externalUrl: "https://my-n8n.example.com"
envSettings:
  N8N_API_KEY: "your-api-key"
```

## Workflow Organization

Workflows are stored in `{project}/workflows/`:
- Each workflow is saved as `{workflow-id}.json`
- Use descriptive workflow names for easier identification
- Group related workflows in the same n8n project
 -->
